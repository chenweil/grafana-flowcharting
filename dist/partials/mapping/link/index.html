<!-- 
  Link Mapping
-->

<div class="section gf-form-group">
  <h5 class="section-heading">链接映射</h5>
  <div class="gf-form">
    <span class="gf-form-label width-11">根据
      <info-popover mode="right-normal">
        <span ng-bind-html="$GF.popover('在字段“谁\'ID（uniq）或LABEL中选择数据类型', 'LINKS')">
        </span>
      </info-popover>
    </span>
    <!-- ID INPUT -->
    <div class="gf-form-select-wrapper">
      <select class="gf-form-input width-10" ng-model="rule.data.linkProp"
        ng-options="c.value as c.text for c in editor.propTypes" ng-change="editor.onRulesChange()"></select>
    </div>
  </div>
  <div class="gf-form">
    <!-- ID Regular expression -->
    <gf-form-switch class="gf-form" label="正则表达式" label-class="width-11" checked="rule.data.linkRegEx"
      on-change="editor.onRulesChange()"
      tooltip="如果不在下面的“谁”字段中使用正则表达式来提高性能，请禁用此选项">
    </gf-form-switch>
  </div>
  <!-- TABLE -->
  <table>
    <thead>
      <tr>
        <th>
          <label class="gf-form-label width-7" style="margin-right: 2px;">按钮</label>
        </th>
        <th>
          <label class="gf-form-label width-8" style="margin-right: 2px;">谁
            <info-popover mode="right-normal">
              <span ng-bind-html="$GF.popover('输入形状Id或单击链接按钮', 'LINKS')">
              </span>
            </info-popover>
          </label>
        </th>
        <th>
          <label class="gf-form-label width-8" style="margin-right: 2px;">何时
            <info-popover mode="right-normal">
              <span ng-bind-html="$GF.popover('选择条件将值或文本放置在形状上。', 'LINKS')">
              </span>
            </info-popover>
          </label>
        </th>
        <th>
          <label class="gf-form-label width-10" style="margin-right: 2px;">Url
            <info-popover mode="right-normal">
              <span ng-bind-html="$GF.popover('输入绝对或相对URL', 'MAPPING#Link')"> </span>
            </info-popover></label>
          </label>
        </th>
        <th>
          <label class="gf-form-label width-7" style="margin-right: 2px;">参数
            <info-popover mode="right-normal">
              <span ng-bind-html="$GF.popover('将实际参数应用于URL', 'LINKS')">
              </span>
            </info-popover>
          </label>
        </th>
      </tr>
    </thead>
    <tbody ng-mouseleave="editor.unhighlightAllCells()">
      <tr ng-repeat="link in rule.getLinkMaps()" ng-class="{'gf-form-disabled': link.data.hidden}"
        ng-mouseleave="editor.unselectCell(rule.data.linkProp,link.data.pattern)"
        ng-mouseover="editor.selectCell(rule.data.linkProp,link.data.pattern)">
        <td>
          <div class="gf-form">
            <label class="gf-form-label" style="margin-right: 4px;">
              <i class="fa fa-w fa-remove pointer" bs-tooltip="'删除这个映射对象'"
                ng-click="editor.removeLinkMap(rule,$index);editor.onRulesChange()"></i>
            </label>
            <label class="gf-form-label" ng-if="!link.isHidden()" style="margin-right: 4px;">
              <i class="fa fa-w fa-eye pointer" bs-tooltip="'在规则中隐藏选中的对象图'"
                ng-click="link.hide();editor.onRulesChange()"></i>
            </label>
            <label class="gf-form-label" ng-if="link.isHidden()" style="margin-right: 4px;">
              <i class="fa fa-w fa-eye-slash pointer" bs-tooltip="'在规则中显示所选对象的图形'"
                ng-click="link.show();editor.onRulesChange()"></i>
            </label>
            <label class="gf-form-label" style="margin-right: 4px;" ng-hide="editor.flowchartHandler.isMapping(link)">
              <i class="fa fa-link pointer" ng-click="editor.flowchartHandler.setMap(link, rule.data.linkProp)"
                bs-tooltip="'链接到对象图上'"></i>
            </label>
            <label class="gf-form-label" style="margin-right: 4px;color:orange"
              ng-show="editor.flowchartHandler.isMapping(link)">
              <i class="fa fa-unlink pointer" bs-tooltip="'取消链接对象图形选择'"
                ng-click="editor.flowchartHandler.unsetMap()"></i>
            </label>
          </div>
        </td>
        <td>
          <div class="gf-form">
            <input type="link" id="{{ link.getId() }}" style="margin-right: 2px;"
              placeholder="形状/链接名称的id或正则表达式" class="gf-form-input width-8"
              ng-if="rule.data.linkProp === 'id'" ng-model="link.data.pattern"
              bs-tooltip="'使用/my指定正则表达式。*regex/语法或形状/链接的完整id(参见检查选项卡)'"
              bs-typeahead="editor.getCellNamesById" ng-blur="editor.onRulesChange()" ng-model-onblur
              data-min-length="0" data-items="100" data-placement="right" />
            <input type="link" id="{{ link.getId() }}" style="margin-right: 2px;"
              placeholder="形状/链接名称的id或正则表达式" class="gf-form-input width-8"
              ng-if="rule.data.linkProp === 'value'" ng-model="link.data.pattern"
              bs-tooltip="'使用/my指定正则表达式。*regex/语法或形状/链接的完整id(参见检查选项卡)'"
              bs-typeahead="editor.getCellNamesByValue" ng-blur="editor.onRulesChange()" ng-model-onblur
              data-min-length="0" data-items="100" data-placement="right" />
          </div>
        </td>
        <td>
          <select class="gf-form-input width-8" ng-model="link.data.linkOn"
            ng-options="c.value as c.text for c in editor.linkOn" ng-change="editor.onRulesChange()"></select>
        </td>
        <td>
          <input type="text" style="margin-right: 2px;" class="gf-form-input width-10" bs-tooltip="'输入URL链接'"
            ng-model="link.data.linkUrl" ng-blur="editor.onRulesChange()" data-placement="right" />
        </td>
        <td>
          <gf-form-switch class="gf-form width-7" style="width: 66px;" checked="link.data.linkParams">
          </gf-form-switch>
        </td>

      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td>
          <div class="gf-form">
            <label class="gf-form-label">
              <i class="fa fa-plus pointer" ng-click="rule.addLinkMap('')" style="margin-right: 2px;"></i>
            </label>
          </div>
        </td>
      </tr>
    </tfoot>
  </table>
</div>